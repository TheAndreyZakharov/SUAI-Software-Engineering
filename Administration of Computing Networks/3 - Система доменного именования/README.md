Цель работы:
изучить теорию и практику DNS, научится устанавливать и конфигурировать DNS-сервер.

Задание:

Для настройки DNS-сервера предварительно нужно выполнить следующее.
1. Компьютер, на котором развертывается DNS, должен иметь статический IP-адрес.
2. 
3. В качестве предпочитаемого DNS сервера должен быть указан IP-адрес этого
компьютера, т.е. он должен указывать на самого себя; поле альтернативного DNS сервера
не заполнять.
4. Желательно в имени компьютера установить DNS-суффикс, который соответствует
имени создаваемой зоны. Это необходимо для того, чтобы сервер отвечал не только на
полное доменное имя, но и на сокращенное. Также это способствует корректной работе
динамического обновления данных сервера DDNS.
Проделав все вышеперечисленные настройки и перезагрузив компьютер, можно
приступать к установке сервера.
Установите в виртуальной машине с ALSE сетевой адаптер в режим NAT и, тем самым,
будет обеспечено подключение этой машины к сети Интернет. После запуска этого
сервера присвойте ему имя согласно заданию. Это можно сделать с помощью команды
sudo hostnamectl set-hostname <новое_имя_компьютера>новое_имя_компьютера>
Это имя должно быть известно DNS-серверу будущей доменной сети.
После изменения имени сервера (компьютер) нужно перезагрузить. Для установки DNS-
сервера как правило достаточно выполнить следующие команды
sudo apt install bind9,
sudo apt install dnsutils

Теперь надо сконфигурировать файл для настроек зоны DNS — это файл
/etc/bind/named.conf/local

Параметры файла named.conf.local :
• Секция zone — наименование зоны, которую будет обслуживать сервер, задаётся
в виде доменного имени.
• Параметр type — тип зоны, master означает — первичная.
• Параметр file — файл с данными зоны, выбирается произвольное наименование, но в
Debian системах принято соглашение называть эти файлы как db.имя_зоны.

Получаем следующее:
zone "family.g4xyz.guap.local" {
type master;
file "/etc/bind/zones/db.family.g4xyz.guap.local";
};
zone "10.122.10.in-addr.arpa" {
type master;
file "/etc/bind/zones/db.10.122.10";
};

Далее создаём файлы прямой и обратной зоны и назначаем пользователя bind
владельцем на каталог с зонными файлами для того, чтобы сервис мог оперировать
созданными файлами:

sudo mkdir /etc/bind/zones
sudo touch /etc/bind/zones/db.family.g4xyz.guap.local
sudo touch /etc/bind/zones/db.10.122.10
2
sudo chown -R bind:bind /etc/bind/zones

Далее настраиваем файл прямой зоны /etc/bind/zones/db.family.g4xyz.guap.local
SOA1 — начальная запись зоны, которая указывает, на каком сервере хранится
информация о домене [2].
NS — сервер имён, указывает на DNS-сервер, обслуживающий данный домен.
A — это запись адреса, указывающая соответствие доменного имени и IPv4-адреса.

Приведём листинг нашего файла family.g4xyz.guap.local:
$TTL 604800
@ IN SOA astra-dc.family.g4xyz.guap.local.
root.family.g4xyz.guap.local.
2 ; Serial
604800 ; Refresh
86400 ; Retry
2419200 ; Expire
604800 ) ; Negative Cache TTL
;
@ IN NS astra-dc.family.g4xyz.guap.local.
astra-dc IN A 10.122.10.44
astra-app IN A 10.122.10.143

В файле обратной зоны /etc/bind/zones/db.10.122.10 используется ещё один тип
ресурсных записей DNS: указатель PTR - он отображает IP-адрес в доменное имя.

Листинг для нашего файла db.10.122.10 будет таким:
$TTL 604800
@ IN SOA astra-dc.family.g4xyz.guap.local. root.family.g4xyz.guap.local.
(
2 ; Serial
604800 ; Refresh
86400 ; Retry
2419200 ; Expire
604800 ) ; Negative Cache TTL
;
@ IN NS astra-dc.family.g4xyz.guap.local.
44 IN PTR astra-dc.family.g4xyz.guap.local.
143 IN PTR astra-app.family.g4xyz.guap.local.

Для запуска установленной службы DNS необходимо дать команду:
sudo systemctl start bind9

Созданную конфигурацию DNS можно проверить с помощью следующих команд:
sudo named-checkzone 10.122.10.in-addr.arpa
/etc/bind/zones/db.10.122.10
sudo named-checkzone family.g4xyz.guap.local.
/etc/bind/zones/db.family.g4xyz.guap.local.
sudo named-checkconf
sudo systemctl restart bind9.service
sudo systemctl status bind9.service
3

Проверьте работу DNS с помощью утилиты nslookup сначала на DNS-сервере.
Окончательную проверку работы настроенных служб лучше всего сделать с
использованием клиентского компьютера. Пропингуйте свои компьютеры по короткому
и по длинному имени.

Оформите отчет с помощью скриншотов основных шагов выполнения работы и
защитите отчет.

Индивидуальное задание

Имя строится по правилу

family.g4xyz.guap.local. где family — Ваша фамилия латиницей и с маленькой буквы,
g4xyz — номер Вашей группы;
zakharov, 4133

Имя DNS-сервера - <имя_Вашего_отца>, написано прописными латинскими буквами
sergey

Имя клиентского компьютера должно соответствовать Вашему имени, записанному
латиницей, причем тоже маленькими (прописными) буквами.
andrey

IP-адреса компьютеров взять от второй лабораторной работы.
Клинет – 172.19.14.107/24
Сервер - 172.19.14.7/24
